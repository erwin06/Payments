<div ng-include src="'views/nav-bar.html'"></div>
<div class="container">
    <div class="text-right">
        <h1>Administrador de pagos </h1>
    </div>
    <div class="div-spacer-small"></div>
    <div class="row">
        <div class="col-lg-4 col-md-4 col-xs-4">
            <div class="box bg-green-sea">
                <label>Total a pagar</label><hr/><label>$ {{ totalToPay() }}</label>
            </div>
        </div>
        <div class="col-lg-4 col-md-4 col-xs-4">
            <div class="box bg-light-blue">
                <label>Pagos de otros</label><hr/><label>$ {{ totalToPayFromOthers() }}</label>
            </div>
        </div>
        <div class="col-lg-4 col-md-4 col-xs-4">
            <div class="box bg-orange">
                <label>Mis pagos</label><hr/><label>$ {{ totalToPayFromMe() }}</label>
            </div>
        </div>
    </div>
</div>
<div class="div-spacer-small"></div>
<div class="container">
    <div class="panel-data">
        <div class="title">
            <small ng-click="previusMonth()"><span class="glyphicon glyphicon-arrow-left cursor-pointer"></span></small>
            <label style="min-width: 130px; text-align: center">{{getMonthName(currentMonth)}} {{currentYear}}</label>
            <small ng-click="nextMonth()"><span class="glyphicon glyphicon-arrow-right cursor-pointer"></span></small>
            <input type="text" class="form-control" style="max-width: 300px; float: right" placeholder="Filtrar por producto" ng-model="payFilter"/>
        </div>
    </div>
</div>
<div class="container">
    <table class="table table-style">
        <thead class="cursor-pointer">
            <th class="col-xs-3" ng-click="payOrder='description'">
                Producto
                <span ng-if="payOrder=='description'" style="float:right">
                    <span class="glyphicon glyphicon-sort-by-attributes"></span>
                </span>
            </th>
            <th class="col-xs-1" ng-click="payOrder='amount'">
                Monto
                <span ng-if="payOrder=='amount'" style="float:right">
                    <span class="glyphicon glyphicon-sort-by-attributes"></span>
                </span>
            </th>
            <th class="col-xs-1" ng-click="payOrder='paymentNumber'">
                Cuota
                <span ng-if="payOrder=='paymentNumber'" style="float:right">
                    <span class="glyphicon glyphicon-sort-by-attributes"></span>
                </span>
            </th>
            <th class="col-xs-2" ng-click="payOrder='idCompany'">
                Empresa
                <span ng-if="payOrder=='idCompany'" style="float:right">
                    <span class="glyphicon glyphicon-sort-by-attributes"></span>
                </span>
            </th>
            <th class="col-xs-2" ng-click="payOrder='idOwner'">
                Responsable
                <span ng-if="payOrder=='idOwner'" style="float:right">
                    <span class="glyphicon glyphicon-sort-by-attributes"></span>
                </span>
            </th>
            <th class="col-xs-3" ng-click="payOrder='status'">
                Estado
                <span ng-if="payOrder=='status'" style="float:right">
                    <span class="glyphicon glyphicon-sort-by-attributes"></span>
                </span>
            </th>
        </thead>
        <tbody>
            <tr ng-repeat="pay in store.payments | filter:payFilter | orderBy:payOrder" class="cursor-pointer" ng-class="isSelected(pay.selected)" ng-click="pay.selected =! pay.selected">
                <td class="text-left" ng-click="payDetail(pay.idProduct)">
                    <span class="span-status" >
                        &nbsp;&nbsp;&nbsp;
                    </span>
                    {{ pay.description }}
                </td>
                <td>${{ pay.amount }}</td>
                <td>{{ pay.paymentNumber + "/" + pay.totalPays }}</td>
                <td>{{ getCompanyName(pay.idCompany) }}</td>
                <td>{{ getOwnerName(pay.idOwner) }}</td>
                <td>
                    <label class="label-status" ng-class="getStatusClass(pay.status)" ng-click="changeStatus(pay)">{{ getStatusWording(pay.status)}} <span ng-if="pay.changing" class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span></label>
                </td>
            </tr>
        </tbody>
    </table>
    <div class="loading-pays" ng-if="loadingPays == true">
        <span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span>
    </div>
</div>
<div class="text-right">
    <button class="btn btn-primary" ng-click="saveChanges()" ng-if="saveButton == true">Guardar cambios </button> 
</div>
<div class="div-spacer-small"></div>